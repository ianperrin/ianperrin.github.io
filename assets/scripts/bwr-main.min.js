const mapMarkers={drink:getMarker("fa-coffee","red","circle","fas"),food:getMarker("fa-utensils","green","circle","fas"),bed:getMarker("fa-bed","blue","circle","fas")},maps=[],placeLayers=[],mapDivs=document.querySelectorAll("div.map");let observer;function onIntersection(e){e.forEach((e=>{e.intersectionRatio>0&&(initMap(e.target),observer.unobserve(e.target))}))}function initMap(e){const t=e.id.split("-")[1],o={MapBox:L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'&copy; <a href="https://www.mapbox.com/about/maps/" target="_blank" rel="noopener">Mapbox</a>, &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank" rel="noopener">OpenStreetMap</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoiaWFucGVycmluIiwiYSI6ImNrcmY1NXM2ZDA0ZXUyeGt3b29iZm56NTkifQ.ZzoGHO0lnc5aX4FK5xvO8Q"})};maps[t]=L.map(e.id,{scrollWheelZoom:!1,tap:!1}).addLayer(o.MapBox),maps[t].attributionControl.setPrefix();const a=`/assets/data/bwr-trip-${t}.json`,r={style:getStyle},n=new L.geoJSON.ajax(a,r);n.on("data:loaded",(function(){maps[t].fitBounds(n.getBounds().pad(.1)).setMaxBounds(n.getBounds().pad(.1)).setMinZoom(maps[t].getZoom())})).addTo(maps[t]);const s=document.querySelectorAll(`div#bwr-trip-${t} div.card[data-latlng]`);if(s.forEach(((e,t)=>{})),s){placeLayers[t]=L.featureGroup().addTo(maps[t]);for(let e=0;e<s.length;e++){const o=s[e].dataset;L.marker(JSON.parse(o.latlng),{icon:mapMarkers[o.type]}).bindPopup(getPopupText(o.name,o.location)).on("popupopen",(function(o){document.getElementById(`bwr-trip-${t}-place-${e+1}`).scrollIntoView(!1)})).addTo(placeLayers[t])}}}function getStyle(e){return{color:e.properties.stroke}}function getPopupText(e,t){return`<strong>${e}</strong><br /><em>${t}</em><br />`}function getMarker(e="",t="blue",o="circle",a="glyphicon"){return L.ExtraMarkers.icon({icon:e,markerColor:t,shape:o,prefix:a})}"IntersectionObserver"in window?(observer=new IntersectionObserver(onIntersection,{rootMargin:"250px"}),mapDivs.forEach((e=>{"object"!=typeof e||!("classList"in e)||e.classList.contains("lazy-loaded")||e.classList.contains("lazy-error")||observer.observe(e)}))):mapDivs.forEach(initMap);